std_objects:
  - cob_id_sync
  - communication_cycle_period
  - consumer_heartbeat_time
  - sdo_client_parameter

objects:
  - name: status
    data_type: uint8
    description: the c3 state
    access_type: ro

  - name: reset_timeout
    data_type: uint32
    description: the reset system timeout in seconds
    access_type: const
    default: 86400 # 24 hours

  - name: mode
    data_type: uint8
    description: the oresat system mode
    access_type: ro

  - name: tx_control
    object_type: record
    subindexes:
      - name: enable
        data_type: bool
        description: tx status
        access_type: ro

      - name: timeout
        data_type: uint32
        description: tx enable timeout in seconds
        access_type: const
        default: 1209600 # 2 weeks

      - name: last_enable_timestamp
        data_type: uint32
        description: last tx enable timestamp in seconds
        access_type: ro

  - name: antennas
    object_type: record
    subindexes:
      - name: deployed
        data_type: bool
        description: antennas are deployed
        access_type: ro

      - name: attempts
        data_type: uint8
        description: number of deployment attempts before continuing
        access_type: const
        default: 3

      - name: pre_attempt_timeout
        data_type: uint8
        description: number of seconds before trying to deploy the antennas
        access_type: const
        default: 2700 # 45 minutes

      - name: attempt_timeout
        data_type: uint8
        description: number of seconds for a deployment attempt
        access_type: const
        default: 10

      - name: reattempt_timeout
        data_type: uint8
        description: number of seconds between deployment reattempts
        access_type: const
        default: 15

      - name: deploy_monopole_now
        data_type: bool
        description: deploy the monopole antennas now
        access_type: wo

      - name: deploy_helical_now
        data_type: bool
        description: deploy the helical antenna now
        access_type: wo

      - name: good_test_threshold
        data_type: uint16
        description: |
          when testing the antennas, any voltage (in millivolts) above this threshold is considered good
        access_type: const
        default: 100

      - name: test_monopole_is_good
        data_type: bool
        description: test the monopole antennas
        access_type: ro

      - name: test_helical_is_good
        data_type: bool
        description: test the helical antenna
        access_type: ro

      - name: monopole_voltage
        data_type: uint16
        description: monopole voltage in millivolts
        access_type: ro

      - name: helical_voltage
        data_type: uint16
        description: helical voltage in millivolts
        access_type: ro

  - name: lband
    object_type: record
    subindexes:
      - name: rx_bytes
        data_type: uint32
        description: lband received byte count
        access_type: ro

      - name: rx_packets
        data_type: uint32
        description: lband received packet count
        access_type: ro

      - name: rssi
        data_type: int8
        description: lband rssi of last packet received after lna, filters, and digital channel filter in dB
        access_type: ro

  - name: uhf
    object_type: record
    subindexes :
      - name: rx_bytes
        data_type: uint32
        description: uhf received byte count
        access_type: ro

      - name: rx_packets
        data_type: uint32
        description: uhf received packet count
        access_type: ro

      - name: rssi
        data_type: int8
        description: uhf rssi of last packet received after lna, filters, and digital channel filter in dB
        access_type: ro

  - name: edl
    object_type: record
    subindexes:
      - name: key0
        data_type: octet_str
        description: edl crypto key 0
        access_type: ro
        length: 32

      - name: key1
        data_type: octet_str
        description: edl crypto key 1
        access_type: ro
        length: 32

      - name: key2
        data_type: octet_str
        description: edl crypto key 2
        access_type: ro
        length: 32

      - name: key3
        data_type: octet_str
        description: edl crypto key 3
        access_type: ro
        length: 32

      - name: active_key
        data_type: uint8
        description: selected edl crypto key
        access_type: ro
        high_level: 3

      - name: sequence_count
        data_type: uint32
        description: edl sequence count
        access_type: ro

      - name: rejected_count
        data_type: uint32
        description: edl sequence count
        access_type: ro

      - name: vc1_sequence_count
        data_type: uint32
        description: edl virtual channel 1 sequence count
        access_type: ro

      - name: vc1_rejected_count
        data_type: uint32
        description: edl virtual channel 1 reject count
        access_type: ro

      - name: vc1_expedite_count
        data_type: uint32
        description: edl virtual channel 1 expedite count
        access_type: ro

      - name: last_timestamp
        data_type: uint64
        description: scet timestamp of last valid edl command
        access_type: ro

      - name: timeout
        data_type: uint32
        description: edl timeout in seconds
        access_type: const
        default: 60

  - name: opd
    object_type: record
    subindexes:
      - name: enable
        data_type: bool
        description: opd system enable status
        access_type: rw

      - name: has_fault
        data_type: uint8
        description: opd system circuit has a fault
        access_type: ro

      - name: current
        data_type: uint8
        description: opd system current draw in mA
        access_type: ro

      - name: scan
        data_type: bool
        description: scan for opd nodes
        access_type: wo

      - name: reset
        data_type: bool
        description: reset the opd system
        access_type: wo

      - name: reset_attempts
        data_type: uint8
        description: number of reset attempts for the opd system before it is considered dead
        access_type: rw
        default: 3

      - name: reset_delay
        data_type: uint8
        description: number of seconds between opd system resets
        access_type: rw
        default: 10

      - name: nodes_status_json
        data_type: str
        description: status of all node as a json string
        access_type: ro
        default: "{}"

      - name: node_select
        data_type: uint8
        description: select a opd node via its node id
        access_type: rw

      - name: node_enable
        data_type: bool
        description: enable/disable selected node on write or get current state by read
        access_type: rw

      - name: node_reset
        data_type: bool
        description: reset the selected node
        access_type: wo

      - name: node_reset_attempts
        data_type: uint8
        description: number of reset attempts for a opd node before it is considered dead
        access_type: rw
        default: 3

  - name: beacon
    object_type: record
    subindexes:
      - name: revision
        data_type: uint8
        description: the beacon revision number
        access_type: const
        # default set via beacon.yaml file

      - name: src_callsign
        data_type: str
        description: the beacon source callsign
        access_type: const
        default: "KJ7SAT"

      - name: dest_callsign
        data_type: str
        description: the beacon destination callsign
        access_type: const
        default: "SPACE"

      - name: start_chars
        data_type: str
        description: the beacon start characters
        access_type: const
        default: "{{z"

      - name: delay
        data_type: uint32
        description: delay between beacons in seconds or 0 to disable
        access_type: const
        default: 30

      - name: send_now
        data_type: bool
        description: send a beacon now
        access_type: wo

      - name: last_timestamp
        data_type: uint64
        description: scet timestamp of last beacon
        access_type: ro

  - name: rtc
    object_type: record
    description: rtc info, OreSat0 only as Linux handles the rtc
    subindexes:
      - name: timestamp
        data_type: uint32
        description: the last saved timestamp in seconds

      - name: alarm_a
        data_type: uint32
        description: the last state of alarm a

      - name: alarm_b
        data_type: uint32
        description: the last state of alarm b

      - name: wakeup_interval
        data_type: uint32
        description: the last state of wakeup interval

tpdos:
  - num: 1 # time sync TPDO
    fields:
      - [scet]

fram:
  # DO NOT change this order, only append!
  - [status]
  - [rtc, timestamp]
  - [rtc, alarm_a]
  - [rtc, alarm_b]
  - [rtc, wakeup_interval]
  - [tx_control, last_enable_timestamp]
  - [edl, last_timestamp]
  - [antenna, deployed]
  - [system, power_cycles]
  - [lband, rx_bytes]
  - [lband, rx_packets]
  - [edl, vc1_sequence_count]
  - [edl, vc1_expedite_count]
  - [edl, sequence_count]
  - [edl, rejected_count]
  - [crypto, key0]
  - [crypto, key1]
  - [crypto, key2]
  - [crypto, key3]
  - [crypto, active_key]
